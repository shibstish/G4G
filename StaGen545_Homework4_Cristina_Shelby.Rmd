---
title: "Homework 4"
author: "Shelby and Cristina"
date: "3/27/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Question 1: The package should contain at least three inputs (y, X, and C) that are R numeric data frame objects. Their dimensions are n by 1, n by m, and n by t, corresponding to phenotype, genotype, and covariate data, where n is number of individuals, m is number of markers, and t is number of covariates. The function should return probability values with dimensions of 1 by m for the association tests between phenotypes and markers. Markers are tested one at a time with covariates in C included as covariates (15 points).

See file G4G.r in the G4G package up on GitHub


Question 2: The package should perform PCA and incorporate PCs as cofactors for GWAS.  Your package should also automatically exclude the PCs that are in linear dependence with the covariates provided by users. (25 points).

See file G4G.r in the G4G package up on GitHub

Question 3:	Develop a user manual and tutorials. Name your package and create a logo. (20 points).

We've named our package "G4G", as an abbreviation of "GLM for GWAS". The package and package logo can be found up on GitHub.


Question 4: Perform GWAS on the data provided or your own data, which must contain cofactors (15 points).

```{r}
#load the package and data
source("/Homework4CristinaandShelby/R/G4G.R")
load("/Homework4CristinaandShelby/demoHW4_covariates.RData")
load("/Homework4CristinaandShelby/demoHW4_genotypes.RData")
load("/Homework4CristinaandShelby/demoHW4_mapinfo.RData")
load("/Homework4CristinaandShelby/demoHW4_phenotypes.RData")

G4G(pheno = pheno, geno = geno, covar = covariates, map = myGM)

```

Question 5:	Demonstrate that your method is superior to the competing method (GWASbyCor) through simulation with at least 30 replicates (25 points).

```{r}
source("http://zzlab.net/StaGen/2020/R/GWASbyCor.R")
start_cor <- Sys.time()
rep(GWASbyCor(geno, pheno), n = 30)
end_cor <- Sys.time()
total_cor <- end_cor - start_cor
total_cor


rep(G4G(pheno = pheno, geno = geno, covar = covariates, map = myGM), n = 30) #this function outputs the total run time

```
P-values generated by GWASbyCor have NA values scattered throughout. The G4G function takes covariate data and calculates principle component influence into account when generating the p-values, so p-values generated from the G4G function are more accurate. What's more, there are no NA p-values generated in the G4G package. G4G may take a few seconds more than then GWASbyCor, but the accuracy is better. 